<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Conta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" th:href="@{/css/styles.css}"/>
</head>
<body>
<div class="container mt-4">
    <h2>Cadastro / Operações de Conta</h2>

    <h4>Criar Conta</h4>
    <form th:object="${criarConta}" method="post" th:action="@{/conta}">
        <div class="mb-2"><label>CPF</label><input th:field="*{cpf}" class="form-control"/></div>
        <div class="mb-2"><label>CPF Conjunto (opcional)</label><input th:field="*{cpfConjunto}" class="form-control"/>
        </div>
        <div class="mb-2"><label>Nome Conjunto</label><input th:field="*{nomeConjunto}" class="form-control"/></div>
        <div class="mb-2"><label>Senha Conjunta</label><input th:field="*{senhaConjunta}" class="form-control"/></div>
        <div class="mb-2"><label>Tipo de Conta</label>
            <select th:field="*{tipoConta}" class="form-control">
                <option value="CORRENTE">Corrente</option>
                <option value="POUPANCA">Poupança</option>
            </select>
        </div>
        <div class="mb-2"><label>Agência</label>
            <select th:field="*{codigoAgencia}" class="form-control">
                <option th:each="ag : ${agencias}" th:value="${ag.codigo}" th:text="${ag.nome}">Ag</option>
            </select>
        </div>
        <button class="btn btn-primary" type="submit" name="action" value="Criar">Criar</button>
    </form>
    <hr/>

    <h4>Buscar / Excluir Conta</h4>
    <form th:object="${conta}" method="post" th:action="@{/conta}">
        <div class="mb-2">
            <label>Código da Conta</label>
            <input th:field="*{codigo}" class="form-control"/>
        </div>
        <div>
            <button class="btn btn-info" type="submit" name="action" value="Buscar">Buscar</button>
            <button class="btn btn-danger" type="submit" name="action" value="Excluir">Excluir</button>
        </div>
    </form>

    <hr/>

    <h4>Operações (saldo/limite/rendimento)</h4>
    <form th:object="${atualizar}" method="post" th:action="@{/conta}">
        <div class="mb-2"><label>Código da Conta</label><input th:field="*{codigo}" class="form-control"/></div>
        <div class="mb-2"><label>Saldo</label><input th:field="*{saldo}" class="form-control"/></div>
        <div class="mb-2"><label>Limite</label><input th:field="*{limite}" class="form-control"/></div>
        <div class="mb-2"><label>Rendimento</label><input th:field="*{rendimento}" class="form-control"/></div>
        <div>
            <button class="btn btn-warning" type="submit" name="action" value="Atualizar-Saldo">Atualizar Saldo</button>
            <button class="btn btn-warning" type="submit" name="action" value="Atualizar-Limite">Atualizar Limite
            </button>
            <button class="btn btn-warning" type="submit" name="action" value="Atualizar-Rendimento">Atualizar
                Rendimento
            </button>
            <button class="btn btn-danger" type="submit" name="action" value="Excluir">Excluir</button>
            <button class="btn btn-info" type="submit" name="action" value="Listar">Listar</button>
        </div>
    </form>

    <div class="mt-3">
        <div th:if="${saida}" class="alert alert-success" th:text="${saida}"></div>
        <div th:if="${erro}" class="alert alert-danger" th:text="${erro}"></div>
    </div>

    <div th:if="${contas}">
        <h3>Contas</h3>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>ID</th>
                <th>Código</th>
                <th>Data Abertura</th>
                <th>Saldo</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="c : ${contas}">
                <td th:text="${c.id}"></td>
                <td th:text="${c.codigo}"></td>
                <td th:text="${c.dataAbertura}"></td>
                <td th:text="${c.saldo}"></td>
                <td>
                    <a th:href="@{/conta/segundo-titular(contaCodigo=${c.codigo})}" class="btn btn-sm btn-secondary">Adicionar
                        2º titular</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</div>
</body>
</html>